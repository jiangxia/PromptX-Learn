# æŠ€æœ¯å‚è€ƒèµ„æ–™

> **PromptX é¡¹ç›®æ·±åº¦æŠ€æœ¯èµ„æ–™**
> ç³»ç»Ÿæ¶æ„ã€æŠ€æœ¯å®ç°ã€å¼€å‘è§„èŒƒçš„å®Œæ•´å‚è€ƒæ–‡æ¡£

## ğŸ“ ç³»ç»Ÿæ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„å›¾

```mermaid
graph TB
    subgraph "AIåº”ç”¨å±‚"
        A[Claude Desktop]
        B[Cursor]
        C[å…¶ä»–AIå®¢æˆ·ç«¯]
    end

    subgraph "MCPåè®®å±‚"
        D[MCP Server]
        E[å‡½æ•°æ˜ å°„]
        F[è–„é€‚é…å™¨]
    end

    subgraph "PromptXæ ¸å¿ƒå±‚"
        G[é”¦å›Šç³»ç»Ÿ]
        H[DPMLè§£æå™¨]
        I[èµ„æºç®¡ç†å™¨]
        J[è®°å¿†ç³»ç»Ÿ]
    end

    subgraph "èµ„æºå±‚"
        K[è§’è‰²å®šä¹‰]
        L[å·¥å…·ç³»ç»Ÿ]
        M[çŸ¥è¯†åº“]
        N[è®°å¿†å­˜å‚¨]
    end

    A --> D
    B --> D
    C --> D
    D --> E
    E --> F
    F --> G
    G --> H
    G --> I
    G --> J
    H --> K
    I --> L
    J --> N
    K --> M
```

### æ ¸å¿ƒè®¾è®¡ç†å¿µ

**"AI use CLI get prompt for AI"**

- AI é€šè¿‡å‘½ä»¤è¡Œæ¥å£è·å–æç¤ºè¯æ¥å¢å¼ºè‡ªèº«èƒ½åŠ›
- è¿™ä¸æ˜¯ç®€å•çš„å·¥å…·è°ƒç”¨ï¼Œè€Œæ˜¯ä¸€ä¸ªå®Œæ•´çš„ AI èƒ½åŠ›å¾ªç¯å¢å¼ºç³»ç»Ÿ
- å®ç°äº†ä»ä¼ ç»Ÿ AI å·¥å…·åˆ°ä¸»åŠ¨å­¦ä¹ ä¸“ä¸šåŠ©æ‰‹çš„è½¬å˜

### å››å±‚åŒæç¤ºè¯å¾ªç¯æ¶æ„

1. **ğŸ‘‘ Master (äººç±»ä¸»æ§)**

   - èº«ä»½ï¼šå†³ç­–åˆ¶å®šè€…ï¼Œç³»ç»Ÿçš„æœ€ç»ˆç”¨æˆ·
   - èŒè´£ï¼šæå‡ºéœ€æ±‚å’Œç›®æ ‡ï¼Œåšå‡ºå…³é”®å†³ç­–ï¼Œè¯„ä¼° AI çš„æœåŠ¡è´¨é‡
   - äº¤äº’æ–¹å¼ï¼šè‡ªç„¶è¯­è¨€ï¼ˆç”¨æˆ·æç¤ºè¯ï¼‰

2. **ğŸ¤– AI (æ™ºèƒ½ä¸­é—´å±‚)**

   - èº«ä»½ï¼šæ™ºèƒ½ä»£ç†ï¼Œæ ¸å¿ƒåè°ƒè€…
   - èŒè´£ï¼šç†è§£éœ€æ±‚ï¼Œåˆ¤æ–­æ‰€éœ€ä¸“ä¸šèƒ½åŠ›ï¼Œæ“ä½œ PromptX ç³»ç»Ÿï¼Œå†…åŒ–ç³»ç»Ÿæç¤ºè¯
   - ç‰¹ç‚¹ï¼šåŒé‡èº«ä»½ - æ—¢æ˜¯ Master çš„æœåŠ¡è€…ï¼Œåˆæ˜¯ PromptX çš„ç”¨æˆ·

3. **ğŸ–¥ï¸ Interface Layer (æ¥å£å±‚)**

   - èº«ä»½ï¼šAI çš„æ“ä½œç•Œé¢ï¼Œç³»ç»Ÿçš„ç”¨æˆ·ç•Œé¢
   - èŒè´£ï¼šæä¾›æ ‡å‡†åŒ–çš„æ“ä½œæ¥å£ï¼Œè§£ææ“ä½œæŒ‡ä»¤ï¼Œæ ¼å¼åŒ–è¿”å›ç»“æœ
   - æ¥å£ç±»å‹ï¼šCLI æ¥å£ã€RESTful APIã€WebSocket æ¥å£

4. **ğŸ’» PromptX System (ç³»ç»Ÿå±‚)**
   - èº«ä»½ï¼šæ ¸å¿ƒè®¡ç®—ç³»ç»Ÿï¼Œèµ„æºç®¡ç†å™¨
   - èŒè´£ï¼šå­˜å‚¨å’Œç®¡ç† DPML æ ¼å¼çš„ä¸“ä¸šçŸ¥è¯†ï¼Œè§£æå’Œæ‰§è¡Œå‘½ä»¤ï¼Œç»´æŠ¤ç³»ç»ŸçŠ¶æ€
   - æ ¸å¿ƒèƒ½åŠ›ï¼šé«˜æ•ˆçš„çŸ¥è¯†æ£€ç´¢å’ŒçŠ¶æ€ç®¡ç†

---

## ğŸ”¤ DPML åè®®è¯¦è§£

### è®¾è®¡ç†å¿µ

DPML (Deepractice Prompt Markup Language) æ˜¯ä¸“ä¸ºæç¤ºè¯å·¥ç¨‹è®¾è®¡çš„è¯­ä¹‰åŒ–æ ‡è®°è¯­è¨€ï¼š

- **è‡ªç„¶è¯­è¨€é©±åŠ¨**ï¼šæç¤ºè¯æœ¬è´¨æ˜¯è‡ªç„¶è¯­è¨€çš„ç»“æ„åŒ–è¡¨è¾¾
- **é‡Šä¹‰å³å®ç°**ï¼šAI ç†è§£è¯­ä¹‰çš„è¿‡ç¨‹å°±æ˜¯æ‰§è¡Œè¿‡ç¨‹
- **è¯­ä¹‰é€æ˜æ€§**ï¼šæ ‡ç­¾åç§°å…·æœ‰è‡ªè§£é‡Šæ€§

### æ ¸å¿ƒè¯­æ³•ç»“æ„

```xml
<role>
  <personality>
    @!thought://domain-specific-thinking
    æˆ‘æ˜¯ä¸“ä¸šçš„[é¢†åŸŸ]ä¸“å®¶ï¼Œå…·å¤‡[æ ¸å¿ƒç‰¹å¾]...
  </personality>
  <principle>
    @!execution://domain-workflow
    @!execution://quality-standards
  </principle>
  <knowledge>
    ä»…å†™é¡¹ç›®ç‰¹å®šçš„çº¦æŸå’ŒSeanåŸåˆ›æ¦‚å¿µ...
  </knowledge>
</role>
```

### ä¸‰ç»„ä»¶æ¶æ„

#### 1. Personality (æ€ç»´æ¨¡å¼ç¼–æ’)

- **ä½œç”¨**ï¼šå®šä¹‰ AI è§’è‰²çš„æ€è€ƒæ–¹å¼å’Œè®¤çŸ¥æ¨¡å¼
- **è¯­æ³•**ï¼š`@!thought://` å¼•ç”¨æ€ç»´æ¨¡å¼
- **å†…å®¹**ï¼šè§’è‰²çš„æ ¸å¿ƒèº«ä»½ã€ä¸“ä¸šç‰¹å¾ã€è®¤çŸ¥åå¥½

#### 2. Principle (è¡Œä¸ºæ¨¡å¼ç¼–æ’)

- **ä½œç”¨**ï¼šå®šä¹‰ AI è§’è‰²çš„æ‰§è¡Œæ–¹å¼å’Œå·¥ä½œåŸåˆ™
- **è¯­æ³•**ï¼š`@!execution://` å¼•ç”¨è¡Œä¸ºæ¨¡å¼
- **å†…å®¹**ï¼šå·¥ä½œæµç¨‹ã€è´¨é‡æ ‡å‡†ã€å¤„ç†åŸåˆ™

#### 3. Knowledge (çŸ¥è¯†ä½“ç³»ç¼–æ’)

- **ä½œç”¨**ï¼šå®šä¹‰ä¸“ä¸šé¢†åŸŸçš„ç»“æ„åŒ–çŸ¥è¯†ä½“ç³»
- **è¯­æ³•**ï¼š`@!knowledge://` å¼•ç”¨çŸ¥è¯†æ¨¡å—
- **å†…å®¹**ï¼šä»…å†™ Sean åŸåˆ›æ¦‚å¿µå’Œé¡¹ç›®ç‰¹å®šçº¦æŸ

### å¼•ç”¨æœºåˆ¶

```xml
<!-- å¼ºåˆ¶å¼•ç”¨ï¼šå¿…é¡»æˆåŠŸè§£æ -->
@!thought://judicial-thinking

<!-- å¯é€‰å¼•ç”¨ï¼šå…è®¸è§£æå¤±è´¥ -->
@?knowledge://optional-knowledge

<!-- ç›´æ¥å¼•ç”¨ï¼šåŸºç¡€å¼•ç”¨æ–¹å¼ -->
@execution://basic-process
```

### åè®®å®ç°ç»‘å®š

```xml
<store:execution>
  # å­˜å‚¨æ“ä½œé€šè¿‡executionåè®®å®ç°
  å…·ä½“çš„å­˜å‚¨é€»è¾‘å’Œæµç¨‹
</store:execution>

<recall:resource>
  # æ£€ç´¢æ“ä½œé€šè¿‡resourceåè®®å®ç°
  å…·ä½“çš„æ£€ç´¢é€»è¾‘å’Œç­–ç•¥
</recall:resource>
```

---

## ğŸ”Œ MCP åè®®é›†æˆ

### æŠ€æœ¯æ¶æ„

MCP (Model Context Protocol) æ˜¯è¿æ¥ AI å®¢æˆ·ç«¯å’Œ PromptX ç³»ç»Ÿçš„æ¡¥æ¢ï¼š

```javascript
// é›¶å¼€é”€è°ƒç”¨è·¯å¾„
MCPè¯·æ±‚ â†’ å‚æ•°æ˜ å°„ â†’ cli.execute() â†’ PouchOutput â†’ MCPå“åº”
```

### å…­å¤§æ ¸å¿ƒå·¥å…·

#### 1. promptx_init

```javascript
{
  name: "promptx_init",
  description: "åˆå§‹åŒ–PromptXå·¥ä½œç¯å¢ƒ",
  parameters: {
    workingDirectory: "å·¥ä½œç›®å½•ç»å¯¹è·¯å¾„",
    ideType: "IDEç±»å‹ï¼ˆå¯é€‰ï¼‰"
  }
}
```

#### 2. promptx_welcome

```javascript
{
  name: "promptx_welcome",
  description: "å‘ç°å¯ç”¨çš„ä¸“ä¸šè§’è‰²",
  parameters: {} // æ— å‚æ•°
}
```

#### 3. promptx_action

```javascript
{
  name: "promptx_action",
  description: "æ¿€æ´»æŒ‡å®šçš„ä¸“ä¸šè§’è‰²",
  parameters: {
    role: "è§’è‰²IDï¼Œå¦‚copywriter, product-manager"
  }
}
```

#### 4. promptx_learn

```javascript
{
  name: "promptx_learn",
  description: "å­¦ä¹ æŒ‡å®šçš„ä¸“ä¸šèµ„æº",
  parameters: {
    resource: "èµ„æºURLï¼Œå¦‚@role://copywriter"
  }
}
```

#### 5. promptx_recall

```javascript
{
  name: "promptx_recall",
  description: "æ£€ç´¢ç›¸å…³è®°å¿†",
  parameters: {
    role: "è§’è‰²ID",
    query: "æ£€ç´¢å…³é”®è¯ï¼ˆå¯é€‰ï¼‰"
  }
}
```

#### 6. promptx_remember

```javascript
{
  name: "promptx_remember",
  description: "ä¿å­˜é‡è¦ä¿¡æ¯",
  parameters: {
    role: "è§’è‰²ID",
    content: "è¦ä¿å­˜çš„å†…å®¹",
    tags: "æ ‡ç­¾ï¼Œç©ºæ ¼åˆ†éš”ï¼ˆå¯é€‰ï¼‰"
  }
}
```

### PATEOAS çŠ¶æ€æœº

```mermaid
stateDiagram-v2
    [*] --> initial
    initial --> initialized: init
    initialized --> service_discovery: welcome
    service_discovery --> role_activated: action
    role_activated --> role_activated_with_memory: recall
    role_activated_with_memory --> role_activated_with_memory: remember
    role_activated_with_memory --> role_activated_with_memory: learn
    role_activated_with_memory --> service_discovery: welcome
    role_activated_with_memory --> initial: init
```

---

## ğŸ¯ é”¦å›Šæ¡†æ¶ (Pouch Framework)

### è®¾è®¡ç†å¿µ

åŸºäº PATEOAS (Prompt as the Engine of Application State) ç†å¿µçš„ AI-First CLI æ¡†æ¶ï¼š

- **è‡ªåŒ…å«çš„ä¸“å®¶çŸ¥è¯†å•å…ƒ**ï¼šç‹¬ç«‹æ‰§è¡Œï¼Œä¸ä¾èµ–ä¸Šä¸‹æ–‡
- **çŠ¶æ€é©±åŠ¨çš„å¯¼èˆªç³»ç»Ÿ**ï¼šé€šè¿‡ PATEOAS å¼•å¯¼ä¸‹ä¸€æ­¥æ“ä½œ
- **AI å‹å¥½çš„æ¥å£è®¾è®¡**ï¼šä¸“ä¸º AI ä½¿ç”¨è€Œä¼˜åŒ–

### æ ¸å¿ƒç»„ä»¶

```javascript
// åŸºç¡€å‘½ä»¤æŠ½è±¡ç±»
class BasePouchCommand {
  getPurpose() {
    return "å‘½ä»¤çš„ç›®çš„è¯´æ˜";
  }

  async getContent(args) {
    return "æ ¸å¿ƒå†…å®¹ï¼ˆæç¤ºè¯ï¼‰";
  }

  getPATEOAS(args) {
    return {
      currentState: "current-state",
      availableTransitions: ["next-command"],
      nextActions: [
        {
          name: "ä¸‹ä¸€æ­¥æ“ä½œ",
          description: "æ“ä½œæè¿°",
          command: "promptx next-command",
        },
      ],
    };
  }
}
```

### å‘½ä»¤ç³»ç»Ÿ

#### InitCommand - åˆå§‹åŒ–å‘½ä»¤

```javascript
class InitCommand extends BasePouchCommand {
  getPurpose() {
    return "åˆå§‹åŒ–å·¥ä½œç¯å¢ƒï¼Œåˆ›å»ºå¿…è¦çš„é…ç½®ç›®å½•å’Œæ–‡ä»¶";
  }

  async getContent(args) {
    // åˆ›å»º .promptx ç›®å½•
    // ç”Ÿæˆé¡¹ç›®èµ„æºæ³¨å†Œè¡¨
    // é…ç½®MCPè¿æ¥
    return "åˆå§‹åŒ–å®Œæˆä¿¡æ¯";
  }
}
```

#### WelcomeCommand - è§’è‰²å‘ç°å‘½ä»¤

```javascript
class WelcomeCommand extends BasePouchCommand {
  getPurpose() {
    return "å‘ç°å¹¶å±•ç¤ºæ‰€æœ‰å¯ç”¨çš„ä¸“ä¸šè§’è‰²";
  }

  async getContent(args) {
    // æ‰«æç³»ç»Ÿè§’è‰²
    // æ‰«æç”¨æˆ·è‡ªå®šä¹‰è§’è‰²
    // ç”Ÿæˆè§’è‰²æ¸…å•
    return "è§’è‰²å‘ç°ç»“æœ";
  }
}
```

#### ActionCommand - è§’è‰²æ¿€æ´»å‘½ä»¤

```javascript
class ActionCommand extends BasePouchCommand {
  getPurpose() {
    return "æ¿€æ´»æŒ‡å®šè§’è‰²ï¼ŒåŠ è½½å…¶å®Œæ•´å®šä¹‰å’Œèƒ½åŠ›";
  }

  async getContent(args) {
    // è§£æè§’è‰²å®šä¹‰
    // åŠ è½½ä¾èµ–èµ„æº
    // æ¸²æŸ“å®Œæ•´æç¤ºè¯
    return "æ¿€æ´»åçš„è§’è‰²å®šä¹‰";
  }
}
```

### ä¸‰å±‚è¾“å‡ºç»“æ„

æ¯ä¸ªé”¦å›Šéƒ½è¾“å‡ºä¸‰å±‚ä¿¡æ¯ï¼š

1. **Purposeï¼ˆç›®çš„ï¼‰**ï¼šè¯´æ˜é”¦å›Šçš„ä½œç”¨
2. **Contentï¼ˆå†…å®¹ï¼‰**ï¼šæ ¸å¿ƒæç¤ºè¯æˆ–çŸ¥è¯†
3. **PATEOASï¼ˆå¯¼èˆªï¼‰**ï¼šä¸‹ä¸€æ­¥æ“ä½œæŒ‡å¼•

---

## ğŸ—‚ï¸ èµ„æºç®¡ç†ç³»ç»Ÿ

### èµ„æºåè®®ä½“ç³»

```javascript
// ç»Ÿä¸€èµ„æºåè®®
@role://video-copywriter           // è§’è‰²å®šä¹‰
@thought://creative-thinking       // æ€ç»´æ¨¡å¼
@execution://content-creation      // æ‰§è¡Œæ¡†æ¶
@knowledge://domain-knowledge      // ä¸“ä¸šçŸ¥è¯†
@memory://success-cases           // å†å²ç»éªŒ
@tool://calculator                // å·¥å…·å®šä¹‰
@manual://tool-usage              // å·¥å…·æ‰‹å†Œ
@package://tool-package           // å·¥å…·åŒ…
@project://specific-config        // é¡¹ç›®é…ç½®
@file://local-resource            // æœ¬åœ°æ–‡ä»¶
@prompt://template-id             // æç¤ºè¯æ¨¡æ¿
@user://custom-resource           // ç”¨æˆ·èµ„æº
```

### èµ„æºå‘ç°æœºåˆ¶

```javascript
class DiscoveryManager {
  async discoverResources(baseDir) {
    const discoveries = [
      new FilePatternDiscovery(),
      new PackageDiscovery(),
      new ProjectDiscovery(),
      new CrossPlatformFileScanner(),
    ];

    const resources = [];
    for (const discovery of discoveries) {
      const found = await discovery.discover(baseDir);
      resources.push(...found);
    }

    return resources;
  }
}
```

### èµ„æºæ³¨å†Œè¡¨

```json
{
  "version": "1.0.0",
  "timestamp": "2025-01-01T00:00:00.000Z",
  "resources": {
    "role": {
      "nuwa": {
        "path": "resource/role/nuwa/nuwa.role.md",
        "type": "role",
        "title": "å¥³å¨² - AIè§’è‰²åˆ›é€ ä¸“å®¶"
      }
    },
    "thought": {
      "role-creation": {
        "path": "resource/role/nuwa/thought/role-creation.thought.md",
        "type": "thought",
        "title": "è§’è‰²åˆ›é€ æ€ç»´æ¨¡å¼"
      }
    }
  }
}
```

---

## ğŸ§  è®°å¿†ç³»ç»Ÿæ¶æ„

### è®°å¿†å­˜å‚¨æœºåˆ¶

```javascript
class MemorySystem {
  async remember(role, content, tags = []) {
    // 1. å†…å®¹æ™ºèƒ½å¤„ç†
    const processed = await this.processContent(content);

    // 2. ä»·å€¼è¯„ä¼°
    const value = await this.evaluateValue(processed);

    // 3. æ ‡ç­¾ç”Ÿæˆ
    const autoTags = await this.generateTags(processed);

    // 4. å­˜å‚¨åˆ°è§’è‰²ä¸“å±è®°å¿†åº“
    await this.store(role, {
      content: processed,
      tags: [...tags, ...autoTags],
      value: value,
      timestamp: Date.now(),
    });
  }

  async recall(role, query = "") {
    // 1. è¯­ä¹‰æœç´¢
    const semanticMatches = await this.semanticSearch(role, query);

    // 2. å…³é”®è¯åŒ¹é…
    const keywordMatches = await this.keywordSearch(role, query);

    // 3. æ—¶é—´å…³è”
    const timeMatches = await this.timeBasedSearch(role);

    // 4. ç»“æœåˆå¹¶å’Œæ’åº
    return this.mergeAndRank([
      ...semanticMatches,
      ...keywordMatches,
      ...timeMatches,
    ]);
  }
}
```

### è®°å¿†ä»·å€¼è¯„ä¼°

```javascript
class ValueEvaluator {
  evaluate(content) {
    const criteria = [
      this.isUserSpecificInfo(content), // ç”¨æˆ·ç‰¹å®šä¿¡æ¯
      this.isProjectSpecificInfo(content), // é¡¹ç›®ç‰¹å®šä¿¡æ¯
      this.isExperientialInfo(content), // ç»éªŒæ€§ä¿¡æ¯
      this.isCorrectionInfo(content), // çº é”™æ€§ä¿¡æ¯
    ];

    return criteria.reduce((score, criterion) => {
      return score + (criterion ? 25 : 0);
    }, 0);
  }
}
```

---

## ğŸ”§ å·¥å…·ç³»ç»Ÿæ¶æ„

### å·¥å…·æ²™ç®±æœºåˆ¶

```javascript
class ToolSandbox {
  constructor() {
    this.isolation = new SandboxIsolationManager();
    this.validator = new ToolValidator();
    this.errorManager = new SandboxErrorManager();
  }

  async executetool(toolResource, parameters) {
    // 1. å·¥å…·éªŒè¯
    await this.validator.validate(toolResource, parameters);

    // 2. æ²™ç®±éš”ç¦»
    const sandbox = await this.isolation.create();

    // 3. å·¥å…·æ‰§è¡Œ
    try {
      const result = await sandbox.execute(toolResource, parameters);
      return result;
    } catch (error) {
      return this.errorManager.handleError(error);
    } finally {
      await sandbox.cleanup();
    }
  }
}
```

### å·¥å…·å¼€å‘è§„èŒƒ

```javascript
// å·¥å…·å®šä¹‰ç¤ºä¾‹
const toolDefinition = {
  name: "calculator",
  description: "åŸºç¡€æ•°å­¦è®¡ç®—å·¥å…·",
  parameters: {
    type: "object",
    properties: {
      expression: {
        type: "string",
        description: "æ•°å­¦è¡¨è¾¾å¼",
      },
    },
    required: ["expression"],
  },

  async execute(params) {
    // å·¥å…·å®ç°é€»è¾‘
    return eval(params.expression);
  },
};
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. èµ„æºç¼“å­˜æœºåˆ¶

```javascript
class ResourceCache {
  constructor() {
    this.cache = new Map();
    this.ttl = 15 * 60 * 1000; // 15åˆ†é’Ÿ
  }

  get(key) {
    const item = this.cache.get(key);
    if (!item) return null;

    if (Date.now() - item.timestamp > this.ttl) {
      this.cache.delete(key);
      return null;
    }

    return item.data;
  }

  set(key, data) {
    this.cache.set(key, {
      data,
      timestamp: Date.now(),
    });
  }
}
```

### 2. æ‡’åŠ è½½æœºåˆ¶

```javascript
class LazyLoader {
  constructor() {
    this.loaded = new Set();
    this.loading = new Map();
  }

  async load(resourceId) {
    if (this.loaded.has(resourceId)) {
      return this.getFromCache(resourceId);
    }

    if (this.loading.has(resourceId)) {
      return this.loading.get(resourceId);
    }

    const promise = this.loadResource(resourceId);
    this.loading.set(resourceId, promise);

    try {
      const result = await promise;
      this.loaded.add(resourceId);
      this.loading.delete(resourceId);
      return result;
    } catch (error) {
      this.loading.delete(resourceId);
      throw error;
    }
  }
}
```

### 3. å¹¶è¡Œå¤„ç†ä¼˜åŒ–

```javascript
class ParallelProcessor {
  async processResources(resources) {
    // æ‰¹é‡å¹¶è¡Œå¤„ç†
    const chunks = this.chunk(resources, 5);
    const results = [];

    for (const chunk of chunks) {
      const chunkResults = await Promise.all(
        chunk.map((resource) => this.processResource(resource))
      );
      results.push(...chunkResults);
    }

    return results;
  }
}
```

---

## ğŸš€ éƒ¨ç½²å’Œè¿ç»´

### å¼€å‘ç¯å¢ƒé…ç½®

```json
{
  "scripts": {
    "start": "PROMPTX_ENV=development node src/bin/promptx.js",
    "test": "jest",
    "lint": "eslint src/",
    "build": "webpack --mode production"
  },
  "dependencies": {
    "@modelcontextprotocol/sdk": "^1.12.1",
    "commander": "^11.0.0",
    "express": "^5.1.0",
    "fs-extra": "^11.1.0",
    "glob": "^10.3.0",
    "yaml": "^2.3.0"
  }
}
```

### ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–

```javascript
// ç”Ÿäº§ç¯å¢ƒé…ç½®
const productionConfig = {
  // ç¼“å­˜ç­–ç•¥
  cache: {
    enabled: true,
    ttl: 30 * 60 * 1000, // 30åˆ†é’Ÿ
    maxSize: 1000,
  },

  // å¹¶å‘æ§åˆ¶
  concurrency: {
    maxConcurrent: 10,
    timeout: 30000,
  },

  // æ—¥å¿—é…ç½®
  logging: {
    level: "info",
    format: "json",
    transport: "file",
  },
};
```

### é”™è¯¯å¤„ç†å’Œç›‘æ§

```javascript
class ErrorHandler {
  constructor() {
    this.logger = new Logger();
    this.metrics = new Metrics();
  }

  handleError(error, context) {
    // è®°å½•é”™è¯¯
    this.logger.error({
      error: error.message,
      stack: error.stack,
      context: context,
      timestamp: Date.now(),
    });

    // æ›´æ–°æŒ‡æ ‡
    this.metrics.increment("errors.total");
    this.metrics.increment(`errors.${error.type}`);

    // é”™è¯¯æ¢å¤
    if (error.recoverable) {
      return this.recover(error, context);
    }

    throw error;
  }
}
```

---

## ğŸ“š å¼€å‘è§„èŒƒ

### ä»£ç è§„èŒƒ

```javascript
// æ–‡ä»¶å‘½åè§„èŒƒ
// - ç±»æ–‡ä»¶ä½¿ç”¨ PascalCase: UserManager.js
// - å‡½æ•°æ–‡ä»¶ä½¿ç”¨ camelCase: validateInput.js
// - å¸¸é‡æ–‡ä»¶ä½¿ç”¨ UPPER_CASE: CONFIG.js

// ç±»å®šä¹‰è§„èŒƒ
class ResourceManager {
  constructor(options = {}) {
    this.options = { ...defaultOptions, ...options };
    this.cache = new Map();
  }

  async loadResource(id) {
    // æ–¹æ³•å®ç°
  }

  // ç§æœ‰æ–¹æ³•ä½¿ç”¨ _ å‰ç¼€
  _validateId(id) {
    // éªŒè¯é€»è¾‘
  }
}
```

### æµ‹è¯•è§„èŒƒ

```javascript
// å•å…ƒæµ‹è¯•ç¤ºä¾‹
describe("ResourceManager", () => {
  let resourceManager;

  beforeEach(() => {
    resourceManager = new ResourceManager();
  });

  describe("loadResource", () => {
    it("should load valid resource", async () => {
      const resource = await resourceManager.loadResource("valid-id");
      expect(resource).toBeDefined();
    });

    it("should throw error for invalid resource", async () => {
      await expect(resourceManager.loadResource("invalid-id")).rejects.toThrow(
        "Resource not found"
      );
    });
  });
});
```

### æ–‡æ¡£è§„èŒƒ

```javascript
/**
 * èµ„æºç®¡ç†å™¨ - è´Ÿè´£ç³»ç»Ÿèµ„æºçš„å‘ç°ã€åŠ è½½å’Œç®¡ç†
 *
 * @class ResourceManager
 * @since 1.0.0
 * @example
 * const manager = new ResourceManager();
 * const resource = await manager.loadResource('role://copywriter');
 */
class ResourceManager {
  /**
   * åŠ è½½æŒ‡å®šçš„èµ„æº
   *
   * @param {string} id - èµ„æºID
   * @param {Object} options - åŠ è½½é€‰é¡¹
   * @param {boolean} options.cache - æ˜¯å¦ä½¿ç”¨ç¼“å­˜
   * @returns {Promise<Resource>} èµ„æºå¯¹è±¡
   * @throws {ResourceNotFoundError} èµ„æºä¸å­˜åœ¨æ—¶æŠ›å‡º
   */
  async loadResource(id, options = {}) {
    // å®ç°ä»£ç 
  }
}
```

---

## ğŸ”® æ‰©å±•å¼€å‘æŒ‡å—

### è‡ªå®šä¹‰åè®®å¼€å‘

```javascript
// åˆ›å»ºè‡ªå®šä¹‰åè®®
class CustomProtocol {
  constructor() {
    this.name = "custom";
    this.pattern = /^@custom:\/\/(.+)$/;
  }

  async resolve(url, context) {
    const match = url.match(this.pattern);
    if (!match) return null;

    const resourceId = match[1];
    return await this.loadCustomResource(resourceId, context);
  }

  async loadCustomResource(id, context) {
    // è‡ªå®šä¹‰èµ„æºåŠ è½½é€»è¾‘
    return {
      id,
      content: "Custom resource content",
      type: "custom",
    };
  }
}

// æ³¨å†Œè‡ªå®šä¹‰åè®®
const protocolRegistry = new ProtocolRegistry();
protocolRegistry.register(new CustomProtocol());
```

### è‡ªå®šä¹‰å·¥å…·å¼€å‘

```javascript
// åˆ›å»ºè‡ªå®šä¹‰å·¥å…·
const customTool = {
  name: "my-custom-tool",
  description: "è‡ªå®šä¹‰å·¥å…·æè¿°",

  parameters: {
    type: "object",
    properties: {
      input: {
        type: "string",
        description: "è¾“å…¥å‚æ•°",
      },
    },
    required: ["input"],
  },

  async execute(params) {
    // å·¥å…·é€»è¾‘å®ç°
    return `å¤„ç†ç»“æœ: ${params.input}`;
  },
};

// æ³¨å†Œå·¥å…·
const toolRegistry = new ToolRegistry();
toolRegistry.register(customTool);
```

### è‡ªå®šä¹‰è§’è‰²æ¨¡æ¿

```xml
<!-- è‡ªå®šä¹‰è§’è‰²æ¨¡æ¿ -->
<role>
  <personality>
    @!thought://[é¢†åŸŸ]-thinking
    æˆ‘æ˜¯ä¸“ä¸šçš„[é¢†åŸŸ]ä¸“å®¶ï¼Œå…·å¤‡[æ ¸å¿ƒç‰¹å¾]...
  </personality>

  <principle>
    @!execution://[é¢†åŸŸ]-workflow
    @!execution://quality-standards

    ## æ ¸å¿ƒå·¥ä½œåŸåˆ™
    - ä¸“ä¸šå¯¼å‘ï¼šå§‹ç»ˆä»¥[é¢†åŸŸ]ä¸“ä¸šæ ‡å‡†ä¸ºå‡†
    - ç”¨æˆ·ä»·å€¼ï¼šä»¥ç”¨æˆ·éœ€æ±‚ä¸ºæ ¸å¿ƒ
    - è´¨é‡ä¿è¯ï¼šç¡®ä¿è¾“å‡ºè´¨é‡å’Œå‡†ç¡®æ€§
  </principle>

  <knowledge>
    ## [é¢†åŸŸ]ç‰¹å®šçº¦æŸ
    - ä¸“ä¸šè§„èŒƒï¼šéµå¾ª[é¢†åŸŸ]è¡Œä¸šæ ‡å‡†
    - å·¥å…·é™åˆ¶ï¼šä½¿ç”¨æŒ‡å®šçš„å·¥å…·å’Œæµç¨‹
    - è´¨é‡æ ‡å‡†ï¼šè¾¾åˆ°[é¢†åŸŸ]ä¸“ä¸šæ°´å¹³
  </knowledge>
</role>
```

---

è¿™ä»½æŠ€æœ¯å‚è€ƒèµ„æ–™æä¾›äº† PromptX é¡¹ç›®çš„å®Œæ•´æŠ€æœ¯æ¶æ„å’Œå®ç°ç»†èŠ‚ï¼Œå¯ä»¥ä½œä¸ºæ·±å…¥å­¦ä¹ å’Œå¼€å‘çš„æƒå¨å‚è€ƒã€‚å»ºè®®ç»“åˆå®é™…ä»£ç é˜…è¯»å’Œå®è·µæ¥æ·±åŒ–ç†è§£ã€‚
